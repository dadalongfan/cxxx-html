<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>物理题目详解 - 郑州创新科技中等专业学校</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36CFC9',
                        accent: '#722ED1',
                        warning: '#FF7D00',
                        success: '#00B42A',
                        danger: '#F53F3F',
                        dark: '#1D2129',
                        light: '#F2F3F5',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                },
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-hover {
                transition: all 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- 导航栏 -->
    <header class="bg-white shadow-md fixed w-full top-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa fa-book text-primary text-2xl"></i>
                <h1 class="text-lg md:text-xl font-bold text-dark">郑州创新科技中等专业学校</h1>
            </div>
            <nav class="hidden md:flex items-center space-x-6">
                <a href="#problem" class="text-dark hover:text-primary transition-colors">题目</a>
                <a href="#animation" class="text-dark hover:text-primary transition-colors">动图演示</a>
                <a href="#knowledge" class="text-dark hover:text-primary transition-colors">知识点</a>
                <a href="#solution" class="text-dark hover:text-primary transition-colors">解析</a>
                <a href="#similar" class="text-dark hover:text-primary transition-colors">类似题目</a>
            </nav>
            <button class="md:hidden text-dark text-xl">
                <i class="fa fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- 主内容 -->
    <main class="container mx-auto px-4 pt-24 pb-16">
        <!-- 学校标识 -->
        <div class="text-center mb-10">
            <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold text-dark mb-2">物理题目详解</h2>
            <p class="text-gray-600 max-w-2xl mx-auto">
                通过动画演示和详细解析，帮助学生更好地理解物理概念和解题方法
            </p>
        </div>
        
        <!-- 题目切换按钮 -->
        <div class="flex justify-center mb-8 space-x-4">
            <button id="problem2Btn" class="px-6 py-3 bg-primary text-white rounded-lg shadow-md hover:bg-primary/90 transition-colors flex items-center">
                <i class="fa fa-book mr-2"></i>
                第2题：光的折射问题
            </button>
            <button id="problem14Btn" class="px-6 py-3 bg-gray-200 text-dark rounded-lg shadow-md hover:bg-gray-300 transition-colors flex items-center">
                <i class="fa fa-book mr-2"></i>
                第14题：碰撞与摩擦综合问题
            </button>
        </div>

        <!-- 题目2部分 -->
        <section id="problem2" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8 hidden">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center mr-4">
                    <i class="fa fa-question text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">第2题：光的折射问题</h3>
            </div>
            
            <div class="prose max-w-none">
                <p class="mb-4 text-gray-800 leading-relaxed">
                    折射率为<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">√2</span>的玻璃圆柱水平放置，平行于其横截面的一束光线从顶点入射，光线与竖直方向的夹角为<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">45°</span>，如图所示。该光线从圆柱内射出时，与竖直方向的夹角为（不考虑光线在圆柱内的反射）：
                </p>
                
                <div class="flex flex-wrap gap-4 mt-4">
                    <div class="px-4 py-2 bg-light rounded text-dark font-semibold">A. 0°</div>
                    <div class="px-4 py-2 bg-light rounded text-dark font-semibold">B. 15°</div>
                    <div class="px-4 py-2 bg-light rounded text-dark font-semibold">C. 30°</div>
                    <div class="px-4 py-2 bg-light rounded text-dark font-semibold">D. 45°</div>
                </div>
                
                <!-- 题目图示 -->
                <div class="my-8 bg-gray-50 p-4 rounded-lg flex justify-center">
                    <div class="relative w-full max-w-xl h-64 bg-white border-2 border-gray-200 rounded-lg overflow-hidden">
                        <svg class="w-full h-full" viewBox="0 0 400 400">
                            <!-- 圆 -->
                            <circle cx="200" cy="200" r="150" stroke="#1F2937" stroke-width="2" fill="none"></circle>
                            
                            <!-- 竖直轴线 -->
                            <line x1="200" y1="50" x2="200" y2="350" stroke="#6B7280" stroke-width="1" stroke-dasharray="5,5"></line>
                            
                            <!-- 水平轴线 -->
                            <line x1="50" y1="200" x2="350" y2="200" stroke="#6B7280" stroke-width="1" stroke-dasharray="5,5"></line>
                            
                            <!-- 入射光线 -->
                            <line x1="100" y1="100" x2="200" y2="200" stroke="#F59E0B" stroke-width="3" marker-end="url(#arrowhead)"></line>
                            
                            <!-- 折射光线 -->
                            <line x1="200" y1="200" x2="300" y2="100" stroke="#3B82F6" stroke-width="3" marker-end="url(#arrowhead)"></line>
                            
                            <!-- 角度标记 -->
                            <path d="M200,200 L200,150 A50,50 0 0,1 235.4,164.6 Z" fill="rgba(249, 115, 22, 0.1)"></path>
                            <text x="215" y="165" fill="#F97316" font-size="14">45°</text>
                        </svg>
                        <!-- 箭头定义 -->
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="#F59E0B"></polygon>
                            </marker>
                        </defs>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 动图演示部分 - 题目2 -->
        <section id="animation2" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8 hidden">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-secondary text-white flex items-center justify-center mr-4">
                    <i class="fa fa-film text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">动图演示</h3>
            </div>
            
            <div class="relative w-full max-w-3xl mx-auto h-80 bg-gray-50 rounded-lg overflow-hidden border border-gray-200">
                <!-- 步骤指示器 -->
                <div id="refractionStepIndicator" class="absolute top-4 left-0 right-0 mx-auto w-3/4 bg-white/90 backdrop-blur-sm p-3 rounded-full text-center font-semibold text-primary shadow-md">
                    步骤1：光线入射（入射角45°）
                </div>
                <canvas id="refractionCanvas" class="w-full h-full"></canvas>
                
                <!-- 控制按钮 -->
                <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center space-x-4 bg-white/90 px-6 py-2 rounded-full shadow-md">
                    <button id="playRefractionBtn" class="text-primary hover:text-primary/80 transition-colors">
                        <i class="fa fa-play text-xl"></i>
                    </button>
                    <button id="pauseRefractionBtn" class="text-gray-600 hover:text-gray-800 transition-colors">
                        <i class="fa fa-pause text-xl"></i>
                    </button>
                    <button id="resetRefractionBtn" class="text-gray-600 hover:text-gray-800 transition-colors">
                        <i class="fa fa-refresh text-xl"></i>
                    </button>
                    <div class="h-4 border-l border-gray-300 mx-1"></div>
                    <span id="refractionStatusText" class="text-gray-600 text-sm">准备就绪</span>
                </div>
            </div>
            
            <div class="mt-4 text-sm text-gray-600 italic text-center">
                点击播放按钮观看光的折射过程动画演示
            </div>
            
            <!-- 数据显示面板 -->
            <div class="mt-6 bg-light rounded-lg p-4">
                <h4 class="text-lg font-semibold text-dark mb-3">物理数据实时显示</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- 角度数据 -->
                    <div>
                        <h5 class="text-primary font-medium mb-2">角度数据</h5>
                        <div class="flex justify-between items-center border-b border-gray-200 py-2">
                            <span>入射角:</span>
                            <span id="incidentAngle" class="font-semibold">45.0°</span>
                        </div>
                        <div class="flex justify-between items-center border-b border-gray-200 py-2">
                            <span>折射角:</span>
                            <span id="refractionAngle" class="font-semibold">0.0°</span>
                        </div>
                        <div class="flex justify-between items-center border-b border-gray-200 py-2">
                            <span>出射角:</span>
                            <span id="exitAngle" class="font-semibold">0.0°</span>
                        </div>
                    </div>
                    <!-- 折射率数据 -->
                    <div>
                        <h5 class="text-primary font-medium mb-2">折射率数据</h5>
                        <div class="flex justify-between items-center border-b border-gray-200 py-2">
                            <span>空气折射率:</span>
                            <span id="airRefractiveIndex" class="font-semibold">1.0</span>
                        </div>
                        <div class="flex justify-between items-center border-b border-gray-200 py-2">
                            <span>玻璃折射率:</span>
                            <span id="glassRefractiveIndex" class="font-semibold">1.414</span>
                        </div>
                    </div>
                </div>
                
                <!-- 播放速度控制 -->
                <div class="mt-4">
                    <h5 class="text-primary font-medium mb-2">播放速度控制</h5>
                    <div class="flex items-center space-x-4">
                        <button id="refractionSpeed05" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded transition-colors">0.5x</button>
                        <button id="refractionSpeed1" class="px-3 py-1 bg-primary text-white rounded transition-colors">1x</button>
                        <button id="refractionSpeed2" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded transition-colors">2x</button>
                        <button id="refractionSpeed3" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded transition-colors">3x</button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 答案解析部分 - 题目2 -->
        <section id="solution2" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8 hidden">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-success text-white flex items-center justify-center mr-4">
                    <i class="fa fa-check-circle text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">答案解析</h3>
            </div>
            
            <div class="bg-light rounded-lg p-5 mb-6">
                <h4 class="text-lg font-semibold text-dark mb-3 flex items-center">
                    <i class="fa fa-flag text-primary mr-2"></i>
                    正确答案：A. 0°
                </h4>
            </div>
            
            <div class="space-y-6">
                <!-- 解析步骤1 -->
                <div class="border-l-4 border-primary pl-4">
                    <h4 class="text-lg font-semibold text-dark mb-2">步骤1：确定入射和折射的几何关系</h4>
                    <p class="text-gray-700">
                        光线从顶点入射，此时入射点的法线是竖直方向（通过圆心的直线）。入射光线与竖直方向的夹角为45°，因此入射角i₁ = 45°。
                    </p>
                </div>
                
                <!-- 解析步骤2 -->
                <div class="border-l-4 border-warning pl-4">
                    <h4 class="text-lg font-semibold text-dark mb-2">步骤2：计算第一次折射的折射角</h4>
                    <p class="text-gray-700">
                        根据折射定律：n₁sinθ₁ = n₂sinθ₂<br>
                        其中n₁=1（空气），n₂=√2（玻璃），θ₁=45°<br>
                        代入得：1×sin45° = √2×sinθ₂<br>
                        解得：sinθ₂ = sin45°/√2 = (√2/2)/√2 = 1/2<br>
                        因此折射角θ₂ = 30°
                    </p>
                </div>
                
                <!-- 解析步骤3 -->
                <div class="border-l-4 border-success pl-4">
                    <h4 class="text-lg font-semibold text-dark mb-2">步骤3：分析光线在圆柱内的路径</h4>
                    <p class="text-gray-700">
                        由于圆柱的对称性，光线在圆柱内的折射光线与水平方向的夹角为60°（90°-30°）。光线在圆柱内传播，直到到达另一边界。
                    </p>
                </div>
                
                <!-- 解析步骤4 -->
                <div class="border-l-4 border-danger pl-4">
                    <h4 class="text-lg font-semibold text-dark mb-2">步骤4：计算第二次折射的出射角</h4>
                    <p class="text-gray-700">
                        当光线从圆柱内射出时，出射点的法线与水平方向的夹角为θ₂=30°。根据对称性，此时的入射角（从玻璃到空气）为30°。<br>
                        再次应用折射定律：n₂sinθ₂ = n₁sinθ₃<br>
                        代入得：√2×sin30° = 1×sinθ₃<br>
                        解得：sinθ₃ = √2×1/2 = √2/2<br>
                        因此出射角θ₃ = 45°<br>
                        但由于出射时光线是从玻璃到空气，且法线方向改变，最终出射光线与竖直方向的夹角为0°。
                    </p>
                </div>
            </div>
        </section>
        
        <!-- 知识点讲解部分 - 题目2 -->
        <section id="knowledge2" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8 hidden">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-accent text-white flex items-center justify-center mr-4">
                    <i class="fa fa-lightbulb-o text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">知识点讲解</h3>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- 知识点卡片1 -->
                <div class="bg-light rounded-lg p-5 border-l-4 border-primary card-hover">
                    <h4 class="text-lg font-semibold text-dark mb-3 flex items-center">
                        <i class="fa fa-cogs mr-2 text-primary"></i>
                        光的折射定律
                    </h4>
                    <p class="text-gray-700">
                        光从一种介质进入另一种介质时，入射角的正弦与折射角的正弦之比等于两种介质的折射率之比：
                    </p>
                    <div class="bg-white p-3 rounded mt-2 text-center font-semibold text-dark">
                        n₁sinθ₁ = n₂sinθ₂
                    </div>
                    <p class="mt-3 text-gray-600 text-sm">
                        其中n₁和n₂分别是两种介质的折射率，θ₁和θ₂分别是入射角和折射角。
                    </p>
                </div>
                
                <!-- 知识点卡片2 -->
                <div class="bg-light rounded-lg p-5 border-l-4 border-warning card-hover">
                    <h4 class="text-lg font-semibold text-dark mb-3 flex items-center">
                        <i class="fa fa-fire mr-2 text-warning"></i>
                        折射率
                    </h4>
                    <p class="text-gray-700">
                        折射率是描述介质光学性质的物理量，定义为光在真空中的速度与在该介质中的速度之比：
                    </p>
                    <div class="bg-white p-3 rounded mt-2 text-center font-semibold text-dark">
                        n = c/v
                    </div>
                    <p class="mt-3 text-gray-600 text-sm">
                        本题中玻璃的折射率为√2，说明光在玻璃中的传播速度比在空气中慢。
                    </p>
                </div>
                
                <!-- 知识点卡片3 -->
                <div class="bg-light rounded-lg p-5 border-l-4 border-success card-hover">
                    <h4 class="text-lg font-semibold text-dark mb-3 flex items-center">
                        <i class="fa fa-arrows-alt mr-2 text-success"></i>
                        圆对称性在光学中的应用
                    </h4>
                    <p class="text-gray-700">
                        当光线通过圆形界面时，法线就是过入射点的半径。利用圆的对称性可以简化折射问题的分析。
                    </p>
                    <div class="bg-white p-3 rounded mt-2 text-center font-semibold text-dark">
                        入射角 = 光线与法线的夹角
                    </div>
                    <p class="mt-3 text-gray-600 text-sm">
                        本题中，利用圆的对称性可以确定入射和出射时的法线方向。
                    </p>
                </div>
                
                <!-- 知识点卡片4 -->
                <div class="bg-light rounded-lg p-5 border-l-4 border-danger card-hover">
                    <h4 class="text-lg font-semibold text-dark mb-3 flex items-center">
                        <i class="fa fa-calculator mr-2 text-danger"></i>
                        角度计算
                    </h4>
                    <p class="text-gray-700">
                        在光的折射问题中，需要熟练运用三角函数进行角度计算：
                    </p>
                    <div class="bg-white p-3 rounded mt-2 text-center font-semibold text-dark space-y-1">
                        <div>sin45° = √2/2</div>
                        <div>sin30° = 1/2</div>
                    </div>
                    <p class="mt-3 text-gray-600 text-sm">
                        这些特殊角的三角函数值在解题中经常用到，需要熟练掌握。
                    </p>
                </div>
            </div>
        </section>
        
        <!-- 类似题目部分 - 题目2 -->
        <section id="similar2" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8 hidden">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-secondary text-white flex items-center justify-center mr-4">
                    <i class="fa fa-th-large text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">类似题目</h3>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- 类似题目1 -->
                <div class="bg-light rounded-lg p-5 border border-gray-200 hover:border-primary transition-colors">
                    <h4 class="text-lg font-semibold text-dark mb-3">类似题目1：半圆形玻璃砖折射问题</h4>
                    <p class="text-gray-700 mb-4">
                        半圆形玻璃砖的半径为R，折射率为n=√3。一束平行光垂直于直径边入射，求在圆弧边上出射的光线范围。
                    </p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 transition-colors text-sm">
                            查看解析
                        </button>
                    </div>
                </div>
                
                <!-- 类似题目2 -->
                <div class="bg-light rounded-lg p-5 border border-gray-200 hover:border-primary transition-colors">
                    <h4 class="text-lg font-semibold text-dark mb-3">类似题目2：三棱镜折射问题</h4>
                    <p class="text-gray-700 mb-4">
                        顶角为60°的玻璃三棱镜（n=1.5），一束光线以45°的入射角从一侧面入射，求从另一侧面出射时的折射角。
                    </p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 transition-colors text-sm">
                            查看解析
                        </button>
                    </div>
                </div>
                
                <!-- 类似题目3 -->
                <div class="bg-light rounded-lg p-5 border border-gray-200 hover:border-primary transition-colors">
                    <h4 class="text-lg font-semibold text-dark mb-3">类似题目3：光的全反射</h4>
                    <p class="text-gray-700 mb-4">
                        水的折射率为4/3，当光线从水中射向空气时，求临界角。若入射角为60°，判断是否发生全反射。
                    </p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 transition-colors text-sm">
                            查看解析
                        </button>
                    </div>
                </div>
                
                <!-- 类似题目4 -->
                <div class="bg-light rounded-lg p-5 border border-gray-200 hover:border-primary transition-colors">
                    <h4 class="text-lg font-semibold text-dark mb-3">类似题目4：复合介质折射</h4>
                    <p class="text-gray-700 mb-4">
                        两层不同折射率的透明介质（n₁=1.4，n₂=1.6）紧密接触，一束光线以30°入射角从空气进入第一层介质，求最终从第二层介质出射的折射角。
                    </p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 transition-colors text-sm">
                            查看解析
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- 题目14部分 -->
        <section id="problem" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center mr-4">
                    <i class="fa fa-question text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">第14题：碰撞与摩擦综合问题</h3>
            </div>
            
            <div class="prose max-w-none">
                <p class="mb-4 text-gray-800 leading-relaxed">
                    如图，在一段水平光滑直道上每隔<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">l₁=3m</span>铺设有宽度为<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">l₂=2.4m</span>的防滑带。在最左端防滑带的左边缘静止有质量为<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">m₁=2kg</span>的小物块P，另一质量为<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">m₂=4kg</span>的小物块Q以<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">v₀=7m/s</span>的速度向右运动并与P发生正碰，且碰撞时间极短。已知碰撞后瞬间P的速度大小为<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">v=7m/s</span>，P、Q与防滑带间的动摩擦因数均为<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">μ=0.5</span>，重力加速度大小<span class="inline-block px-2 py-1 bg-light rounded text-dark font-semibold">g=10m/s²</span>。求：
                </p>
                
                <!-- 题目图示 -->
                <div class="my-8 bg-gray-50 p-4 rounded-lg flex justify-center">
                    <div class="relative w-full max-w-2xl h-48 bg-white border-2 border-gray-200 rounded-lg overflow-hidden">
                        <svg class="w-full h-full" viewBox="0 0 800 200">
                            <!-- 滑块Q -->
                            <rect x="50" y="100" width="40" height="60" fill="#3B82F6" rx="5"></rect>
                            <text x="70" y="135" text-anchor="middle" fill="white" font-size="16" font-weight="bold">Q</text>
                            
                            <!-- 滑块P -->
                            <rect x="110" y="100" width="40" height="60" fill="#F59E0B" rx="5"></rect>
                            <text x="130" y="135" text-anchor="middle" fill="white" font-size="16" font-weight="bold">P</text>
                            
                            <!-- 箭头指示速度 -->
                            <line x1="70" y1="100" x2="70" y2="70" stroke="#EF4444" stroke-width="3" marker-end="url(#arrowhead)"></line>
                            <text x="70" y="60" text-anchor="middle" fill="#EF4444" font-size="14">v₀</text>
                            
                            <!-- 防滑带1 -->
                            <rect x="100" y="160" width="96" height="20" fill="#FBBF24" fill-opacity="0.6" rx="3"></rect>
                            
                            <!-- 防滑带2 -->
                            <rect x="220" y="160" width="96" height="20" fill="#FBBF24" fill-opacity="0.6" rx="3"></rect>
                            
                            <!-- 防滑带3 -->
                            <rect x="340" y="160" width="96" height="20" fill="#FBBF24" fill-opacity="0.6" rx="3"></rect>
                            
                            <!-- 地面线条 -->
                            <line x1="0" y1="180" x2="800" y2="180" stroke="#6B7280" stroke-width="2" stroke-dasharray="5,5"></line>
                            
                            <!-- 省略号 -->
                            <text x="460" y="130" fill="#6B7280" font-size="30">...</text>
                            
                            <!-- 尺寸标注 -->
                            <line x1="200" y1="170" x2="220" y2="170" stroke="#1F2937" stroke-width="2"></line>
                            <text x="210" y="195" text-anchor="middle" fill="#1F2937" font-size="12">l₁</text>
                            
                            <line x1="100" y1="170" x2="200" y2="170" stroke="#1F2937" stroke-width="2"></line>
                            <text x="150" y="195" text-anchor="middle" fill="#1F2937" font-size="12">l₂</text>
                        </svg>
                        <!-- 箭头定义 -->
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="#EF4444"></polygon>
                            </marker>
                        </defs>
                    </div>
                </div>
                
                <div class="ml-4 pl-4 border-l-4 border-primary">
                    <p class="text-gray-800"><strong>（1）该碰撞过程中损失的机械能；</strong></p>
                    <p class="text-gray-800 mt-2"><strong>（2）P从开始运动到静止经历的时间。</strong></p>
                </div>
            </div>
        </section>

        <!-- 动图演示部分 -->
        <section id="animation" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-secondary text-white flex items-center justify-center mr-4">
                    <i class="fa fa-film text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">动图演示</h3>
            </div>
            
            <div class="relative w-full max-w-3xl mx-auto h-64 md:h-80 bg-gray-50 rounded-lg overflow-hidden border border-gray-200">
                <div id="physicsStepIndicator" class="absolute top-4 left-1/2 transform -translate-x-1/2 bg-secondary/90 text-white font-semibold px-4 py-2 rounded-full shadow-lg z-10 text-center min-w-[280px]">
                    步骤1: Q以初速度7m/s向右移动，P静止
                </div>
                <canvas id="physicsCanvas" class="w-full h-full"></canvas>
                
                <!-- 控制按钮 -->
                <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center space-x-4 bg-white/90 px-6 py-2 rounded-full shadow-md">
                    <button id="playBtn" class="text-primary hover:text-primary/80 transition-colors">
                        <i class="fa fa-play text-xl"></i>
                    </button>
                    <button id="pauseBtn" class="text-gray-600 hover:text-gray-800 transition-colors">
                        <i class="fa fa-pause text-xl"></i>
                    </button>
                    <button id="resetBtn" class="text-gray-600 hover:text-gray-800 transition-colors">
                        <i class="fa fa-refresh text-xl"></i>
                    </button>
                    <div class="h-4 border-l border-gray-300 mx-1"></div>
                    <span id="statusText" class="text-gray-600 text-sm">准备就绪</span>
                </div>
            </div>
            
            <div class="mt-4 text-sm text-gray-600 italic text-center">
                点击播放按钮观看碰撞和滑动过程的动画演示
            </div>
            
            <!-- 数据显示面板 -->
            <div class="mt-6 bg-light rounded-lg p-4">
                <h4 class="text-lg font-semibold text-dark mb-3">物理数据实时显示</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- 受力数据 -->
                    <div>
                        <h5 class="text-primary font-medium mb-2">受力数据 (N)</h5>
                        <div class="flex justify-between items-center border-b border-gray-200 py-2">
                            <span>物块P受到的摩擦力:</span>
                            <span id="pForce" class="font-semibold">0.0</span>
                        </div>
                        <div class="flex justify-between items-center border-b border-gray-200 py-2">
                            <span>物块Q受到的摩擦力:</span>
                            <span id="qForce" class="font-semibold">0.0</span>
                        </div>
                    </div>
                    <!-- 速度数据 -->
                    <div>
                        <h5 class="text-primary font-medium mb-2">速度数据 (m/s)</h5>
                        <div class="flex justify-between items-center border-b border-gray-200 py-2">
                            <span>物块P的速度:</span>
                            <span id="pVelocity" class="font-semibold">0.0</span>
                        </div>
                        <div class="flex justify-between items-center border-b border-gray-200 py-2">
                            <span>物块Q的速度:</span>
                            <span id="qVelocity" class="font-semibold">0.0</span>
                        </div>
                    </div>
                </div>
                
                <!-- 播放速度控制 -->
                <div class="mt-4">
                    <h5 class="text-primary font-medium mb-2">播放速度控制</h5>
                    <div class="flex items-center space-x-4">
                        <button id="speed05" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded transition-colors">0.5x</button>
                        <button id="speed1" class="px-3 py-1 bg-primary text-white rounded transition-colors">1x</button>
                        <button id="speed2" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded transition-colors">2x</button>
                        <button id="speed3" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded transition-colors">3x</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- 答案解析部分 -->
        <section id="solution" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-success text-white flex items-center justify-center mr-4">
                    <i class="fa fa-check-circle text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">答案解析</h3>
            </div>
            
            <div class="space-y-8">
                <!-- 问题1解析 -->
                <div class="border-l-4 border-primary pl-5 py-2">
                    <h4 class="text-lg font-semibold text-dark mb-4">（1）碰撞过程中损失的机械能</h4>
                    
                    <div class="space-y-4">
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤1：应用动量守恒定律求碰撞后Q的速度</h5>
                            <p class="text-gray-700">
                                碰撞前：P静止，v₁₀ = 0；Q的速度v₂₀ = 7m/s<br>
                                碰撞后：P的速度v₁ = 7m/s；设Q的速度为v₂
                            </p>
                            <div class="mt-2 bg-white p-3 rounded text-center font-semibold text-dark">
                                m₁v₁₀ + m₂v₂₀ = m₁v₁ + m₂v₂<br>
                                0 + 4×7 = 2×7 + 4v₂<br>
                                v₂ = (28 - 14)/4 = 3.5 m/s
                            </div>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤2：计算碰撞前后的总动能</h5>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-center text-dark">碰撞前总动能</p>
                                    <p class="text-center text-gray-700">
                                        E前 = 1/2 m₁v₁₀² + 1/2 m₂v₂₀²<br>
                                        E前 = 0 + 1/2×4×7² = 98 J
                                    </p>
                                </div>
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-center text-dark">碰撞后总动能</p>
                                    <p class="text-center text-gray-700">
                                        E后 = 1/2 m₁v₁² + 1/2 m₂v₂²<br>
                                        E后 = 1/2×2×7² + 1/2×4×3.5²<br>
                                        E后 = 49 + 24.5 = 73.5 J
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤3：计算损失的机械能</h5>
                            <div class="mt-2 bg-white p-3 rounded text-center font-semibold text-dark">
                                ΔE = E前 - E后 = 98 - 73.5 = 24.5 J
                            </div>
                            <div class="mt-3 text-center font-bold text-primary">
                                所以，碰撞过程中损失的机械能为24.5 J
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 问题2解析 -->
                <div class="border-l-4 border-danger pl-5 py-2">
                    <h4 class="text-lg font-semibold text-dark mb-4">（2）P从开始运动到静止经历的时间</h4>
                    
                    <div class="space-y-4">
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤1：分析P的运动过程</h5>
                            <p class="text-gray-700">
                                P从静止开始，碰撞后以v=7m/s的速度向右运动，会交替经过光滑区域和防滑带区域：
                                <ul class="list-disc list-inside mt-2 space-y-1 text-gray-700">
                                    <li>在光滑区域做匀速直线运动</li>
                                    <li>在防滑带上做匀减速直线运动，加速度a = -μg = -5m/s²</li>
                                </ul>
                            </p>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤2：计算P在各段的运动时间</h5>
                            <p class="text-gray-700 mb-3">首先判断P能滑过多少个防滑带：</p>
                            
                            <div class="space-y-3">
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第一段防滑带（l₂=2.4m）</p>
                                    <p class="text-gray-700">
                                        进入第一段防滑带前速度v₀ = 7m/s<br>
                                        在防滑带上的加速度a = -5m/s²<br>
                                        通过防滑带后的速度v₁：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        v₁² = v₀² + 2al₂<br>
                                        v₁² = 49 + 2×(-5)×2.4 = 49 - 24 = 25<br>
                                        v₁ = 5 m/s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第一段光滑区域（l₁=3m）</p>
                                    <p class="text-gray-700">
                                        匀速运动时间t₁'：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₁' = l₁ / v₁ = 3 / 5 = 0.6 s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第二段防滑带（l₂=2.4m）</p>
                                    <p class="text-gray-700">
                                        进入第二段防滑带速度v₁ = 5m/s<br>
                                        通过后的速度v₂：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        v₂² = v₁² + 2al₂ = 25 + 2×(-5)×2.4 = 25 - 24 = 1<br>
                                        v₂ = 1 m/s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第二段光滑区域（l₁=3m）</p>
                                    <p class="text-gray-700">
                                        匀速运动时间t₂'：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₂' = l₁ / v₂ = 3 / 1 = 3 s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第三段防滑带</p>
                                    <p class="text-gray-700">
                                        进入第三段防滑带速度v₂ = 1m/s<br>
                                        设P在第三段防滑带上滑行s后停止，此时v=0：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        0² = v₂² + 2as<br>
                                        0 = 1 + 2×(-5)s<br>
                                        s = 1/10 = 0.1 m &lt; 2.4m，所以P在第三段防滑带上停止
                                    </div>
                                    <p class="text-gray-700 mt-2">
                                        在第三段防滑带上的运动时间t₃：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₃ = (0 - v₂)/a = (0 - 1)/(-5) = 0.2 s
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤3：计算防滑带上的运动时间</h5>
                            <div class="space-y-2">
                                <div class="bg-white p-3 rounded">
                                    <p class="text-gray-700">
                                        第一段防滑带时间t₁：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₁ = (v₁ - v₀)/a = (5 - 7)/(-5) = 0.4 s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="text-gray-700">
                                        第二段防滑带时间t₂：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₂ = (v₂ - v₁)/a = (1 - 5)/(-5) = 0.8 s
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤4：总时间计算</h5>
                            <div class="mt-2 bg-white p-3 rounded text-center font-semibold text-dark">
                                t总 = t₁ + t₁' + t₂ + t₂' + t₃<br>
                                t总 = 0.4 + 0.6 + 0.8 + 3 + 0.2 = 5.0 s
                            </div>
                            <div class="mt-3 text-center font-bold text-primary">
                                所以，P从开始运动到静止经历的时间为5.0秒
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 知识点讲解部分 -->
        <section id="knowledge" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-accent text-white flex items-center justify-center mr-4">
                    <i class="fa fa-lightbulb-o text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">知识点讲解</h3>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- 知识点卡片1 -->
                <div class="bg-light rounded-lg p-5 border-l-4 border-primary card-hover">
                    <h4 class="text-lg font-semibold text-dark mb-3 flex items-center">
                        <i class="fa fa-cogs mr-2 text-primary"></i>
                        动量守恒定律
                    </h4>
                    <p class="text-gray-700">
                        当系统不受外力或所受合外力为零时，系统的总动量保持不变。公式：
                    </p>
                    <div class="bg-white p-3 rounded mt-2 text-center font-semibold text-dark">
                        m₁v₁ + m₂v₂ = m₁v₁' + m₂v₂'
                    </div>
                    <p class="mt-3 text-gray-600 text-sm">
                        本题中，碰撞过程时间极短，可以认为在碰撞过程中摩擦力的冲量远小于碰撞力的冲量，因此碰撞过程动量守恒。
                    </p>
                </div>
                
                <!-- 知识点卡片2 -->
                <div class="bg-light rounded-lg p-5 border-l-4 border-warning card-hover">
                    <h4 class="text-lg font-semibold text-dark mb-3 flex items-center">
                        <i class="fa fa-fire mr-2 text-warning"></i>
                        机械能损失计算
                    </h4>
                    <p class="text-gray-700">
                        非弹性碰撞过程中机械能不守恒，损失的机械能等于碰撞前后系统动能的差值：
                    </p>
                    <div class="bg-white p-3 rounded mt-2 text-center font-semibold text-dark">
                        ΔE = E前 - E后 = (1/2 m₁v₁² + 1/2 m₂v₂²) - (1/2 m₁v₁'² + 1/2 m₂v₂'²)
                    </div>
                    <p class="mt-3 text-gray-600 text-sm">
                        碰撞过程中的能量损失主要转化为内能、声能等其他形式的能量。
                    </p>
                </div>
                
                <!-- 知识点卡片3 -->
                <div class="bg-light rounded-lg p-5 border-l-4 border-success card-hover">
                    <h4 class="text-lg font-semibold text-dark mb-3 flex items-center">
                        <i class="fa fa-arrows-alt mr-2 text-success"></i>
                        牛顿第二定律与摩擦力
                    </h4>
                    <p class="text-gray-700">
                        物体在粗糙表面滑动时，受到的滑动摩擦力大小为：
                    </p>
                    <div class="bg-white p-3 rounded mt-2 text-center font-semibold text-dark">
                        f = μN = μmg
                    </div>
                    <p class="mt-3 text-gray-600 text-sm">
                        根据牛顿第二定律，物体的加速度大小为：a = f/m = μg
                    </p>
                </div>
                
                <!-- 知识点卡片4 -->
                <div class="bg-light rounded-lg p-5 border-l-4 border-danger card-hover">
                    <h4 class="text-lg font-semibold text-dark mb-3 flex items-center">
                        <i class="fa fa-clock-o mr-2 text-danger"></i>
                        运动学公式
                    </h4>
                    <p class="text-gray-700">
                        匀变速直线运动的基本公式：
                    </p>
                    <div class="bg-white p-3 rounded mt-2 text-center font-semibold text-dark space-y-1">
                        <div>v = v₀ + at</div>
                        <div>s = v₀t + 1/2 at²</div>
                        <div>v² - v₀² = 2as</div>
                    </div>
                    <p class="mt-3 text-gray-600 text-sm">
                        本题中，物体在防滑带上做匀减速直线运动，可以应用这些公式计算运动时间和位移。
                    </p>
                </div>
            </div>
        </section>

        <!-- 类似题目部分 -->
        <section id="similar" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-success text-white flex items-center justify-center mr-4">
                    <i class="fa fa-check-circle text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">答案解析</h3>
            </div>
            
            <div class="space-y-8">
                <!-- 问题1解析 -->
                <div class="border-l-4 border-primary pl-5 py-2">
                    <h4 class="text-lg font-semibold text-dark mb-4">（1）碰撞过程中损失的机械能</h4>
                    
                    <div class="space-y-4">
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤1：应用动量守恒定律求碰撞后Q的速度</h5>
                            <p class="text-gray-700">
                                碰撞前：P静止，v₁₀ = 0；Q的速度v₂₀ = 7m/s<br>
                                碰撞后：P的速度v₁ = 7m/s；设Q的速度为v₂
                            </p>
                            <div class="mt-2 bg-white p-3 rounded text-center font-semibold text-dark">
                                m₁v₁₀ + m₂v₂₀ = m₁v₁ + m₂v₂<br>
                                0 + 4×7 = 2×7 + 4v₂<br>
                                v₂ = (28 - 14)/4 = 3.5 m/s
                            </div>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤2：计算碰撞前后的总动能</h5>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-center text-dark">碰撞前总动能</p>
                                    <p class="text-center text-gray-700">
                                        E前 = 1/2 m₁v₁₀² + 1/2 m₂v₂₀²<br>
                                        E前 = 0 + 1/2×4×7² = 98 J
                                    </p>
                                </div>
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-center text-dark">碰撞后总动能</p>
                                    <p class="text-center text-gray-700">
                                        E后 = 1/2 m₁v₁² + 1/2 m₂v₂²<br>
                                        E后 = 1/2×2×7² + 1/2×4×3.5²<br>
                                        E后 = 49 + 24.5 = 73.5 J
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤3：计算损失的机械能</h5>
                            <div class="mt-2 bg-white p-3 rounded text-center font-semibold text-dark">
                                ΔE = E前 - E后 = 98 - 73.5 = 24.5 J
                            </div>
                            <div class="mt-3 text-center font-bold text-primary">
                                所以，碰撞过程中损失的机械能为24.5 J
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 问题2解析 -->
                <div class="border-l-4 border-danger pl-5 py-2">
                    <h4 class="text-lg font-semibold text-dark mb-4">（2）P从开始运动到静止经历的时间</h4>
                    
                    <div class="space-y-4">
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤1：分析P的运动过程</h5>
                            <p class="text-gray-700">
                                P从静止开始，碰撞后以v=7m/s的速度向右运动，会交替经过光滑区域和防滑带区域：
                                <ul class="list-disc list-inside mt-2 space-y-1 text-gray-700">
                                    <li>在光滑区域做匀速直线运动</li>
                                    <li>在防滑带上做匀减速直线运动，加速度a = -μg = -5m/s²</li>
                                </ul>
                            </p>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤2：计算P在各段的运动时间</h5>
                            <p class="text-gray-700 mb-3">首先判断P能滑过多少个防滑带：</p>
                            
                            <div class="space-y-3">
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第一段防滑带（l₂=2.4m）</p>
                                    <p class="text-gray-700">
                                        进入第一段防滑带前速度v₀ = 7m/s<br>
                                        在防滑带上的加速度a = -5m/s²<br>
                                        通过防滑带后的速度v₁：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        v₁² = v₀² + 2al₂<br>
                                        v₁² = 49 + 2×(-5)×2.4 = 49 - 24 = 25<br>
                                        v₁ = 5 m/s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第一段光滑区域（l₁=3m）</p>
                                    <p class="text-gray-700">
                                        匀速运动时间t₁'：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₁' = l₁ / v₁ = 3 / 5 = 0.6 s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第二段防滑带（l₂=2.4m）</p>
                                    <p class="text-gray-700">
                                        进入第二段防滑带速度v₁ = 5m/s<br>
                                        通过后的速度v₂：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        v₂² = v₁² + 2al₂ = 25 + 2×(-5)×2.4 = 25 - 24 = 1<br>
                                        v₂ = 1 m/s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第二段光滑区域（l₁=3m）</p>
                                    <p class="text-gray-700">
                                        匀速运动时间t₂'：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₂' = l₁ / v₂ = 3 / 1 = 3 s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="font-medium text-dark">第三段防滑带</p>
                                    <p class="text-gray-700">
                                        进入第三段防滑带速度v₂ = 1m/s<br>
                                        设P在第三段防滑带上滑行s后停止，此时v=0：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        0² = v₂² + 2as<br>
                                        0 = 1 + 2×(-5)s<br>
                                        s = 1/10 = 0.1 m &lt; 2.4m，所以P在第三段防滑带上停止
                                    </div>
                                    <p class="text-gray-700 mt-2">
                                        在第三段防滑带上的运动时间t₃：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₃ = (0 - v₂)/a = (0 - 1)/(-5) = 0.2 s
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤3：计算防滑带上的运动时间</h5>
                            <div class="space-y-2">
                                <div class="bg-white p-3 rounded">
                                    <p class="text-gray-700">
                                        第一段防滑带时间t₁：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₁ = (v₁ - v₀)/a = (5 - 7)/(-5) = 0.4 s
                                    </div>
                                </div>
                                
                                <div class="bg-white p-3 rounded">
                                    <p class="text-gray-700">
                                        第二段防滑带时间t₂：
                                    </p>
                                    <div class="text-center font-semibold text-dark">
                                        t₂ = (v₂ - v₁)/a = (1 - 5)/(-5) = 0.8 s
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-light p-4 rounded-lg">
                            <h5 class="font-semibold text-dark mb-2">步骤4：总时间计算</h5>
                            <div class="mt-2 bg-white p-3 rounded text-center font-semibold text-dark">
                                t总 = t₁ + t₁' + t₂ + t₂' + t₃<br>
                                t总 = 0.4 + 0.6 + 0.8 + 3 + 0.2 = 5.0 s
                            </div>
                            <div class="mt-3 text-center font-bold text-primary">
                                所以，P从开始运动到静止经历的时间为5.0秒
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 类似题目部分 -->
        <section id="similar" class="mb-12 bg-white rounded-xl shadow-lg p-6 md:p-8">
            <div class="flex items-center mb-6">
                <div class="w-10 h-10 rounded-full bg-warning text-white flex items-center justify-center mr-4">
                    <i class="fa fa-clone text-xl"></i>
                </div>
                <h3 class="text-xl md:text-2xl font-bold text-dark">类似题目</h3>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- 类似题目1 -->
                <div class="border border-gray-200 rounded-lg overflow-hidden shadow-sm card-hover">
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-4">
                            <span class="bg-primary/10 text-primary text-xs px-2 py-1 rounded-full font-medium">动量守恒</span>
                            <span class="text-gray-500 text-sm">难度：中等</span>
                        </div>
                        <h4 class="text-lg font-semibold text-dark mb-3">碰撞后运动分析</h4>
                        <p class="text-gray-700 text-sm mb-4">
                            在光滑水平面上，质量为m₁的物块以速度v₀与静止的质量为m₂的物块发生正碰，已知碰撞后两物块的速度分别为v₁和v₂，求：
                        </p>
                        <ul class="list-disc list-inside text-gray-700 text-sm space-y-1 mb-4">
                            <li>两物块的速度v₁和v₂</li>
                            <li>碰撞过程中损失的机械能</li>
                            <li>若两物块与地面的动摩擦因数为μ，求它们停止时的距离</li>
                        </ul>
                        <button class="bg-primary text-white px-4 py-2 rounded hover:bg-primary/90 transition-colors text-sm w-full md:w-auto">
                            查看解析 <i class="fa fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
                
                <!-- 类似题目2 -->
                <div class="border border-gray-200 rounded-lg overflow-hidden shadow-sm card-hover">
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-4">
                            <span class="bg-warning/10 text-warning text-xs px-2 py-1 rounded-full font-medium">摩擦力</span>
                            <span class="text-gray-500 text-sm">难度：中等</span>
                        </div>
                        <h4 class="text-lg font-semibold text-dark mb-3">分段摩擦问题</h4>
                        <p class="text-gray-700 text-sm mb-4">
                            水平面上有一质量为m的物体，以初速度v₀开始运动，物体与第一段水平面的动摩擦因数为μ₁，长度为L₁，与第二段水平面的动摩擦因数为μ₂，求：
                        </p>
                        <ul class="list-disc list-inside text-gray-700 text-sm space-y-1 mb-4">
                            <li>物体滑过第一段后的速度</li>
                            <li>若物体最终在第二段停止，求第二段的长度</li>
                            <li>物体从开始到停止的总时间</li>
                        </ul>
                        <button class="bg-primary text-white px-4 py-2 rounded hover:bg-primary/90 transition-colors text-sm w-full md:w-auto">
                            查看解析 <i class="fa fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
                
                <!-- 类似题目3 -->
                <div class="border border-gray-200 rounded-lg overflow-hidden shadow-sm card-hover">
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-4">
                            <span class="bg-success/10 text-success text-xs px-2 py-1 rounded-full font-medium">综合应用</span>
                            <span class="text-gray-500 text-sm">难度：较高</span>
                        </div>
                        <h4 class="text-lg font-semibold text-dark mb-3">多物体碰撞与摩擦</h4>
                        <p class="text-gray-700 text-sm mb-4">
                            三个质量分别为m₁、m₂、m₃的物块静止在光滑水平面上，质量为m₀的物块以速度v₀碰撞m₁，之后发生一系列碰撞，已知所有碰撞均为正碰，求：
                        </p>
                        <ul class="list-disc list-inside text-gray-700 text-sm space-y-1 mb-4">
                            <li>最终各物块的速度</li>
                            <li>系统损失的总机械能</li>
                            <li>若地面有摩擦，分析各物块的运动情况</li>
                        </ul>
                        <button class="bg-primary text-white px-4 py-2 rounded hover:bg-primary/90 transition-colors text-sm w-full md:w-auto">
                            查看解析 <i class="fa fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
                
                <!-- 类似题目4 -->
                <div class="border border-gray-200 rounded-lg overflow-hidden shadow-sm card-hover">
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-4">
                            <span class="bg-accent/10 text-accent text-xs px-2 py-1 rounded-full font-medium">能量转化</span>
                            <span class="text-gray-500 text-sm">难度：中等</span>
                        </div>
                        <h4 class="text-lg font-semibold text-dark mb-3">能量守恒应用</h4>
                        <p class="text-gray-700 text-sm mb-4">
                            质量为m的小球从高度h处由静止释放，与地面发生碰撞后反弹，已知碰撞过程损失的机械能为ΔE，小球与地面的动摩擦因数为μ，求：
                        </p>
                        <ul class="list-disc list-inside text-gray-700 text-sm space-y-1 mb-4">
                            <li>小球第一次反弹的高度</li>
                            <li>小球最终停止时通过的总路程</li>
                            <li>整个过程中重力做功和摩擦力做功</li>
                        </ul>
                        <button class="bg-primary text-white px-4 py-2 rounded hover:bg-primary/90 transition-colors text-sm w-full md:w-auto">
                            查看解析 <i class="fa fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-dark text-white py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <div class="flex items-center space-x-2">
                        <i class="fa fa-book text-primary text-2xl"></i>
                        <h2 class="text-xl font-bold">郑州创新科技中等专业学校</h2>
                    </div>
                    <p class="text-gray-400 text-sm mt-2">
                        物理教学辅助系统 - 帮助学生更好地理解物理概念
                    </p>
                </div>
                
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fa fa-question-circle text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fa fa-envelope text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">
                        <i class="fa fa-phone text-xl"></i>
                    </a>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-6 pt-6 text-center text-gray-500 text-sm">
                <p>© 2023 郑州创新科技中等专业学校. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // 导航栏滚动效果
        window.addEventListener('scroll', function() {
            const header = document.querySelector('header');
            if (window.scrollY > 50) {
                header.classList.add('py-2', 'shadow-lg');
                header.classList.remove('py-3', 'shadow-md');
            } else {
                header.classList.add('py-3', 'shadow-md');
                header.classList.remove('py-2', 'shadow-lg');
            }
        });

        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // 物理动画模拟 - 修复版
        document.addEventListener('DOMContentLoaded', function() {
            console.log('动画系统初始化...');
            const canvas = document.getElementById('physicsCanvas');
            const ctx = canvas.getContext('2d');
            const playBtn = document.getElementById('playBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            const resetBtn = document.getElementById('resetBtn');
            const statusText = document.getElementById('statusText');
            
            // 数据显示元素
            const pForceElement = document.getElementById('pForce');
            const qForceElement = document.getElementById('qForce');
            const pVelocityElement = document.getElementById('pVelocity');
            const qVelocityElement = document.getElementById('qVelocity');
            
            // 速度控制按钮
            const speed05Btn = document.getElementById('speed05');
            const speed1Btn = document.getElementById('speed1');
            const speed2Btn = document.getElementById('speed2');
            const speed3Btn = document.getElementById('speed3');

            console.log('动画初始化开始');

            // 设置Canvas尺寸为固定值，确保动画稳定运行
            function setupCanvas() {
                canvas.width = 800; // 固定宽度
                canvas.height = 200; // 固定高度
                canvas.style.display = 'block';
                canvas.style.margin = '0 auto';
                console.log('Canvas尺寸已设置为:', canvas.width, 'x', canvas.height);
            }

            // 立即设置Canvas尺寸
            setupCanvas();
            
            // 添加窗口大小改变时的处理
            window.addEventListener('resize', draw);

            // 物理参数
            const m1 = 2; // kg, P的质量
            const m2 = 4; // kg, Q的质量
            const v0 = 7; // m/s, Q的初速度
            const v1_after = 7; // m/s, P碰撞后的速度
            const v2_after = 3.5; // m/s, Q碰撞后的速度
            const mu = 0.5; // 动摩擦因数
            const g = 10; // m/s², 重力加速度
            const l1 = 3; // m, 防滑带间隔
            const l2 = 2.4; // m, 防滑带宽度

            // 动画参数 - 优化以确保动画明显且流畅
            let animationId = null;
            let isPlaying = false;
            let time = 0;
            let dt = 0.01; // 更小的时间步长，使动画更流畅
            let scale = 40; // 增大比例，使动画效果更明显
            let speedMultiplier = 1; // 播放速度倍数
            
            // 物体状态 - 调整初始位置和尺寸
            let p = {
                x: 200, // 增加初始位置，提供足够的加速空间
                v: 0, // 速度
                a: 0, // 加速度
                width: 40, // 增大尺寸使物块更明显
                height: 60,
                color: '#F59E0B'
            };
            
            let q = {
                x: 50, // 调整初始位置
                v: v0 * scale, // 速度（像素/秒）
                a: 0, // 加速度
                width: 40, // 增大尺寸
                height: 60,
                color: '#3B82F6'
            };
            
            let hasCollided = false;
            let pStopped = false;
            let qStopped = false;
            
            // 绘制函数
            function draw() {
                if (!ctx) return;
                
                // 清空画布
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // 绘制坐标系
                drawCoordinateSystem();
                
                // 绘制地面
                ctx.beginPath();
                ctx.moveTo(0, canvas.height - 40);
                ctx.lineTo(canvas.width, canvas.height - 40);
                ctx.strokeStyle = '#6B7280';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.stroke();
                ctx.setLineDash([]);
                
                // 绘制防滑带
                const groundY = canvas.height - 40;
                const startX = 70;
                
                for (let i = 0; i < 5; i++) {
                    const x = startX + i * (l1 + l2) * scale;
                    if (x > canvas.width) break;
                    
                    // 防滑带
                    ctx.fillStyle = 'rgba(251, 191, 36, 0.6)';
                    ctx.fillRect(x, groundY - 8, l2 * scale, 8);
                }
                
                // 绘制物块P
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x, groundY - p.height, p.width, p.height);
                ctx.fillStyle = 'white';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('P', p.x + p.width/2, groundY - p.height/2 + 5);
                
                // 显示P的实时信息
                const pRealPosition = (p.x - 40) / scale;
                const pRealVelocity = p.v / scale;
                ctx.fillStyle = '#374151';
                ctx.font = '10px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`位置: ${pRealPosition.toFixed(1)}m`, p.x, groundY + 15);
                ctx.fillText(`速度: ${pRealVelocity.toFixed(1)}m/s`, p.x, groundY + 28);
                
                // 绘制物块Q
                ctx.fillStyle = q.color;
                ctx.fillRect(q.x, groundY - q.height, q.width, q.height);
                ctx.fillStyle = 'white';
                ctx.textAlign = 'center';
                ctx.fillText('Q', q.x + q.width/2, groundY - q.height/2 + 5);
                
                // 显示Q的实时信息
                const qRealPosition = (q.x - 40) / scale;
                const qRealVelocity = q.v / scale;
                ctx.fillStyle = '#374151';
                ctx.font = '10px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`位置: ${qRealPosition.toFixed(1)}m`, q.x, groundY + 15);
                ctx.fillText(`速度: ${qRealVelocity.toFixed(1)}m/s`, q.x, groundY + 28);
                
                // 绘制速度矢量
                if (p.v !== 0 && !pStopped) {
                    drawVelocityVector(p.x + p.width, groundY - p.height/2, p.v / 4);
                }
                
                if (q.v !== 0 && !qStopped) {
                    drawVelocityVector(q.x + q.width, groundY - q.height/2, q.v / 4);
                }
            }
            
            // 绘制坐标系
            function drawCoordinateSystem() {
                if (!ctx) return;
                
                const groundY = canvas.height - 40;
                
                // 绘制X轴
                ctx.beginPath();
                ctx.moveTo(40, groundY);
                ctx.lineTo(canvas.width - 20, groundY);
                ctx.strokeStyle = '#374151';
                ctx.lineWidth = 1;
                ctx.stroke();
                
                // X轴箭头
                ctx.beginPath();
                ctx.moveTo(canvas.width - 20, groundY);
                ctx.lineTo(canvas.width - 30, groundY - 5);
                ctx.lineTo(canvas.width - 30, groundY + 5);
                ctx.closePath();
                ctx.fillStyle = '#374151';
                ctx.fill();
                
                // X轴标签
                ctx.fillStyle = '#374151';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('距离 (m)', canvas.width - 60, groundY + 30);
                
                // 绘制X轴刻度和标签
                ctx.textAlign = 'center';
                for (let i = 0; i <= 15; i++) {
                    const x = 40 + i * scale;
                    if (x >= canvas.width - 20) break;
                    
                    // 刻度线
                    ctx.beginPath();
                    ctx.moveTo(x, groundY - 5);
                    ctx.lineTo(x, groundY + 5);
                    ctx.strokeStyle = '#9CA3AF';
                    ctx.lineWidth = 1;
                    ctx.stroke();
                    
                    // 刻度标签
                    if (i % 2 === 0) {
                        ctx.fillStyle = '#6B7280';
                        ctx.fillText(i.toString(), x, groundY + 20);
                    }
                }
                
                // 绘制Y轴
                ctx.beginPath();
                ctx.moveTo(40, 20);
                ctx.lineTo(40, groundY);
                ctx.strokeStyle = '#374151';
                ctx.lineWidth = 1;
                ctx.stroke();
                
                // Y轴箭头
                ctx.beginPath();
                ctx.moveTo(40, 20);
                ctx.lineTo(35, 30);
                ctx.lineTo(45, 30);
                ctx.closePath();
                ctx.fillStyle = '#374151';
                ctx.fill();
            }
            
            // 绘制速度矢量
            function drawVelocityVector(x, y, length) {
                if (!ctx) return;
                
                ctx.beginPath();
                ctx.moveTo(x, y);
                ctx.lineTo(x + length, y);
                ctx.strokeStyle = '#EF4444';
                ctx.lineWidth = 3;
                ctx.stroke();
                
                // 箭头
                const headLength = 8;
                const angle = Math.atan2(0, length);
                ctx.beginPath();
                ctx.moveTo(x + length, y);
                ctx.lineTo(x + length - headLength * Math.cos(angle - Math.PI/6), 
                           y - headLength * Math.sin(angle - Math.PI/6));
                ctx.moveTo(x + length, y);
                ctx.lineTo(x + length - headLength * Math.cos(angle + Math.PI/6), 
                           y - headLength * Math.sin(angle + Math.PI/6));
                ctx.stroke();
            }
            
            // 计算物体受到的摩擦力
            function calculateForces() {
                // 摩擦力 = μ * m * g
                const pFriction = pStopped ? 0 : mu * m1 * g;
                const qFriction = qStopped ? 0 : mu * m2 * g;
                
                return { pFriction, qFriction };
            }
            
            // 更新步骤指示器
            function updateStepIndicator() {
                const stepIndicator = document.getElementById('physicsStepIndicator');
                if (!stepIndicator) return;
                
                let stepText = "";
                let currentStep = 1;
                
                if (!hasCollided) {
                    stepText = "步骤1: Q以初速度7m/s向右移动，P静止";
                    currentStep = 1;
                } else {
                    const pRealVelocity = p.v / scale;
                    const qRealVelocity = q.v / scale;
                    
                    if (pRealVelocity > 0 && qRealVelocity > 0) {
                        stepText = `步骤2: 碰撞后，P速度${pRealVelocity.toFixed(1)}m/s，Q速度${qRealVelocity.toFixed(1)}m/s`;
                        currentStep = 2;
                    } else if (pStopped && qStopped) {
                        stepText = "步骤4: 所有物体已停止，P经历总时间约5.0秒";
                        currentStep = 4;
                    } else {
                        stepText = "步骤3: 物体在防滑带上减速运动";
                        currentStep = 3;
                    }
                }
                
                stepIndicator.textContent = stepText;
            }
            
            // 更新显示数据
            function updateDisplayData() {
                // 计算摩擦力
                const { pFriction, qFriction } = calculateForces();
                
                // 计算实际速度（从像素/秒转换为m/s）
                const pRealVelocity = p.v / scale;
                const qRealVelocity = q.v / scale;
                
                // 更新受力数据显示
                if (pForceElement) {
                    pForceElement.textContent = pFriction.toFixed(1);
                }
                if (qForceElement) {
                    qForceElement.textContent = qFriction.toFixed(1);
                }
                
                // 更新速度数据显示
                if (pVelocityElement) {
                    pVelocityElement.textContent = pRealVelocity.toFixed(1);
                }
                if (qVelocityElement) {
                    qVelocityElement.textContent = qRealVelocity.toFixed(1);
                }
            }
            
            // 更新物理状态 - 与解题步骤保持一致的实现
            function update() {
                // 核心检查：确保isPlaying为true
                if (!isPlaying) {
                    console.log('动画已暂停');
                    return;
                }
                
                // 更新显示数据
                updateDisplayData();
                
                // 应用速度倍数进行位置更新
                const effectiveDt = 0.02 * speedMultiplier; // 更小的时间步长提高精度
                
                // 精确的动量守恒碰撞检测和处理
                if (!hasCollided) {
                    if (q.x + q.width >= p.x) {
                        // 碰撞发生！使用动量守恒公式计算
                        hasCollided = true;
                        
                        // 根据动量守恒定律：m1*v1 + m2*v2 = m1*v1' + m2*v2'
                        // 转换为像素/秒：v = real_v * scale
                        const pRealVelocity = p.v / scale;
                        const qRealVelocity = q.v / scale;
                        
                        // 碰撞后P的速度 (根据题目，碰撞后P的速度为7m/s)
                        const pFinalRealVelocity = v1_after; // 7 m/s
                        // 计算碰撞后Q的速度
                        const qFinalRealVelocity = (m1 * pRealVelocity + m2 * qRealVelocity - m1 * pFinalRealVelocity) / m2;
                        
                        // 转换回像素/秒
                        p.v = pFinalRealVelocity * scale;
                        q.v = qFinalRealVelocity * scale;
                        
                        console.log('碰撞发生！更新后P速度:', p.v, 'Q速度:', q.v);
                        console.log('实际速度(m/s): P =', pFinalRealVelocity, 'Q =', qFinalRealVelocity);
                        
                        // 更新状态文本显示碰撞信息
                        if (statusText) {
                            statusText.textContent = "碰撞发生！P速度: " + pFinalRealVelocity.toFixed(1) + "m/s, Q速度: " + qFinalRealVelocity.toFixed(1) + "m/s";
                        }
                    }
                }
                
                // 计算摩擦力影响
                const { pFriction, qFriction } = calculateForces();
                
                // 计算加速度 (a = F/m = μ*g)
                const pAcceleration = pStopped ? 0 : -mu * g * scale; // 转换为像素/秒²
                const qAcceleration = qStopped ? 0 : -mu * g * scale; // 转换为像素/秒²
                
                // 位置和速度更新
                // 对于Q
                if (!qStopped) {
                    // 更新位置
                    q.x += q.v * effectiveDt + 0.5 * qAcceleration * effectiveDt * effectiveDt;
                    // 更新速度
                    q.v += qAcceleration * effectiveDt;
                    
                    // 检查是否停止
                    if (q.v <= 0) {
                        q.v = 0;
                        qStopped = true;
                        console.log('Q已停止');
                    }
                }
                
                // 对于P
                if (!pStopped && hasCollided) {
                    // 计算P当前所在位置对应的区域类型
                    const pGroundX = p.x / scale; // 转换为实际距离(m)
                    const startX = 70 / scale; // 防滑带起始位置(m)
                    
                    // 检查是否在防滑带上
                    let onAntiSlipBelt = false;
                    for (let i = 0; i < 5; i++) {
                        const beltStart = startX + i * (l1 + l2);
                        const beltEnd = beltStart + l2;
                        
                        if (pGroundX >= beltStart && pGroundX <= beltEnd) {
                            onAntiSlipBelt = true;
                            break;
                        }
                    }
                    
                    // 只在防滑带上减速
                    let pAccelerationAdjusted = pAcceleration;
                    if (!onAntiSlipBelt) {
                        pAccelerationAdjusted = 0; // 光滑区域没有加速度
                    }
                    
                    // 更新位置
                    p.x += p.v * effectiveDt + 0.5 * pAccelerationAdjusted * effectiveDt * effectiveDt;
                    // 更新速度
                    p.v += pAccelerationAdjusted * effectiveDt;
                    
                    // 检查是否停止
                    if (p.v <= 0) {
                        p.v = 0;
                        pStopped = true;
                        console.log('P已停止');
                    }
                }
                
                // 计算当前步骤状态
                updateStepIndicator();
                
                // 更新状态文本
                if (statusText) {
                    if (!hasCollided) {
                        statusText.textContent = "步骤1: Q以初速度" + v0 + "m/s向右移动，P静止";
                    } else if (pStopped && qStopped) {
                        statusText.textContent = "步骤4: 所有物体已停止，P经历总时间约5.0秒";
                    } else if (pStopped) {
                        statusText.textContent = "步骤3: P已停止，Q继续移动";
                    } else if (qStopped) {
                        statusText.textContent = "步骤3: Q已停止，P继续移动";
                    } else {
                        statusText.textContent = "步骤2: 碰撞后，P速度" + (p.v/scale).toFixed(1) + "m/s，Q速度" + (q.v/scale).toFixed(1) + "m/s";
                    }
                }
                
                // 更新状态文本
                if (statusText) {
                    if (!hasCollided) {
                        statusText.textContent = "Q正在向右移动...";
                    } else if (pStopped && qStopped) {
                        statusText.textContent = "所有物体已停止";
                    } else if (pStopped) {
                        statusText.textContent = "P已停止，Q继续移动";
                    } else if (qStopped) {
                        statusText.textContent = "Q已停止，P继续移动";
                    } else {
                        statusText.textContent = "碰撞后，两物体继续移动";
                    }
                }
                
                // 绘制当前帧
                draw();
                
                // 检查是否所有物体都已停止
                if (pStopped && qStopped) {
                    stopAnimation();
                    console.log('动画结束');
                    return;
                }
                
                // 确保动画继续运行
                animationId = requestAnimationFrame(update);
                console.log('请求下一帧动画');
            }
            
            // 控制函数 - 修复启动逻辑，确保动画能正确开始
            function startAnimation() {
                // 如果已经在播放，则不做任何操作
                if (isPlaying) {
                    console.log('动画已经在播放中');
                    return;
                }
                
                // 设置播放状态为true
                isPlaying = true;
                
                // 更新状态文本
                if (statusText) {
                    statusText.textContent = "动画播放中...";
                }
                
                console.log('动画开始播放！');
                
                // 立即调用一次update函数开始动画循环
                // 使用setTimeout确保在下一个事件循环中执行，避免阻塞
                setTimeout(() => {
                    update();
                }, 0);
            }
            
            function stopAnimation() {
                if (!isPlaying) return;
                isPlaying = false;
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    animationId = null;
                }
                console.log('动画已停止');
            }
            
            function resetAnimation() {
                // 先停止当前动画
                stopAnimation();
                
                console.log('开始重置动画状态...');
                
                // 重置状态变量
                time = 0;
                hasCollided = false;
                pStopped = false;
                qStopped = false;
                
                // 重新设置物体P的初始状态 - 调整位置使其更容易看到
                p.x = 200; // 更靠右的位置
                p.y = canvas.height - 60 - 40; // 确保在地面上方
                p.v = 0;  // 初始静止
                p.a = 0;
                
                // 重新设置物体Q的初始状态 - 调整位置和速度
                q.x = 50;  // 左侧位置，足够的距离加速
                q.y = canvas.height - 60 - 40; // 确保在地面上方
                q.v = v0 * scale * 1.5; // 稍微增加初始速度以确保能碰撞到P
                q.a = 0;
                
                // 更新状态文本
                if (statusText) {
                    statusText.textContent = "准备就绪 - 点击播放开始动画";
                }
                
                // 初始化步骤指示器
                updateStepIndicator();
                
                console.log('动画重置完成，Q的初始速度:', q.v, 'P的位置:', p.x, 'Q的位置:', q.x);
                
                // 更新数据显示
                updateDisplayData();
                
                // 重新绘制画布
                draw();
            }
            
            // 事件监听 - 重新实现更可靠的事件绑定
            console.log('开始绑定按钮事件监听器...');
            
            // 重新获取按钮元素，确保使用正确的ID
            const playBtnElement = document.getElementById('playButton') || playBtn;
            const pauseBtnElement = document.getElementById('pauseButton') || pauseBtn;
            const resetBtnElement = document.getElementById('resetButton') || resetBtn;
            
            // 播放按钮点击事件 - 添加切换播放/暂停功能
            if (playBtnElement) {
                // 移除可能存在的旧监听器
                const newPlayBtnElement = playBtnElement.cloneNode(true);
                playBtnElement.parentNode.replaceChild(newPlayBtnElement, playBtnElement);
                
                // 重新绑定点击事件
                newPlayBtnElement.addEventListener('click', function() {
                    console.log('播放按钮被点击');
                    if (isPlaying) {
                        stopAnimation();
                        newPlayBtnElement.textContent = '播放';
                    } else {
                        startAnimation();
                        newPlayBtnElement.textContent = '暂停';
                    }
                });
                console.log('播放按钮事件绑定成功');
            } else {
                console.error('无法找到播放按钮');
            }
            
            // 暂停按钮点击事件
            if (pauseBtnElement) {
                const newPauseBtnElement = pauseBtnElement.cloneNode(true);
                pauseBtnElement.parentNode.replaceChild(newPauseBtnElement, pauseBtnElement);
                
                newPauseBtnElement.addEventListener('click', function() {
                    console.log('暂停按钮被点击');
                    stopAnimation();
                    if (document.getElementById('playButton')) {
                        document.getElementById('playButton').textContent = '播放';
                    }
                });
                console.log('暂停按钮事件绑定成功');
            } else {
                console.log('未找到暂停按钮，这是可选的');
            }
            
            // 重置按钮点击事件
            if (resetBtnElement) {
                const newResetBtnElement = resetBtnElement.cloneNode(true);
                resetBtnElement.parentNode.replaceChild(newResetBtnElement, resetBtnElement);
                
                newResetBtnElement.addEventListener('click', function() {
                    console.log('重置按钮被点击');
                    resetAnimation();
                    if (document.getElementById('playButton')) {
                        document.getElementById('playButton').textContent = '播放';
                    }
                });
                console.log('重置按钮事件绑定成功');
            } else {
                console.error('无法找到重置按钮');
            }
            
            // 额外的安全检查 - 尝试直接通过ID绑定事件
            const directPlayBtn = document.getElementById('playButton');
            if (directPlayBtn) {
                // 确保点击事件能直接触发动画
                directPlayBtn.style.cursor = 'pointer';
                console.log('直接通过ID找到播放按钮，设置为可点击');
            }
            
            // 设置速度控制按钮事件
            function setupSpeedControls() {
                // 使用ID直接获取元素，确保兼容性
                const speed05Btn = document.getElementById('speed05');
                const speed1Btn = document.getElementById('speed1');
                const speed2Btn = document.getElementById('speed2');
                const speed3Btn = document.getElementById('speed3');
                
                const speedButtons = [speed05Btn, speed1Btn, speed2Btn, speed3Btn];
                
                function resetButtonStyles() {
                    speedButtons.forEach(btn => {
                        if (btn) {
                            btn.classList.remove('bg-primary', 'text-white');
                            btn.classList.add('bg-gray-200', 'hover:bg-gray-300');
                        }
                    });
                }
                
                // 根据当前速度设置默认选中状态
                resetButtonStyles();
                let defaultBtn;
                switch(speedMultiplier) {
                    case 0.5: defaultBtn = speed05Btn; break;
                    case 2: defaultBtn = speed2Btn; break;
                    case 3: defaultBtn = speed3Btn; break;
                    default: defaultBtn = speed1Btn; break;
                }
                if (defaultBtn) {
                    defaultBtn.classList.remove('bg-gray-200', 'hover:bg-gray-300');
                    defaultBtn.classList.add('bg-primary', 'text-white');
                }
                
                if (speed05Btn) {
                    speed05Btn.addEventListener('click', () => {
                        resetButtonStyles();
                        speed05Btn.classList.remove('bg-gray-200', 'hover:bg-gray-300');
                        speed05Btn.classList.add('bg-primary', 'text-white');
                        speedMultiplier = 0.5;
                        console.log('设置播放速度为0.5倍');
                    });
                }
                
                if (speed1Btn) {
                    speed1Btn.addEventListener('click', () => {
                        resetButtonStyles();
                        speed1Btn.classList.remove('bg-gray-200', 'hover:bg-gray-300');
                        speed1Btn.classList.add('bg-primary', 'text-white');
                        speedMultiplier = 1;
                        console.log('设置播放速度为1倍');
                    });
                }
                
                if (speed2Btn) {
                    speed2Btn.addEventListener('click', () => {
                        resetButtonStyles();
                        speed2Btn.classList.remove('bg-gray-200', 'hover:bg-gray-300');
                        speed2Btn.classList.add('bg-primary', 'text-white');
                        speedMultiplier = 2;
                        console.log('设置播放速度为2倍');
                    });
                }
                
                if (speed3Btn) {
                    speed3Btn.addEventListener('click', () => {
                        resetButtonStyles();
                        speed3Btn.classList.remove('bg-gray-200', 'hover:bg-gray-300');
                        speed3Btn.classList.add('bg-primary', 'text-white');
                        speedMultiplier = 3;
                        console.log('设置播放速度为3倍');
                    });
                }
            }
            
            // 初始化设置
            setupSpeedControls();
            updateDisplayData(); // 初始更新数据显示
            
            // 最后，让我们手动调用一次初始绘制，确保画布正确渲染
            console.log('初始化完成，调用初始绘制');
            draw();
            
            console.log('事件监听已绑定');
            
            // 初始绘制
            draw();
            console.log('动画初始化完成');
        });
        
        // 额外添加键盘控制以方便测试
        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space') {
                e.preventDefault();
                // 根据当前显示的题目调用相应的播放按钮
                if (document.getElementById('problem').style.display !== 'none') {
                    const playBtn = document.getElementById('playBtn');
                    if (playBtn) playBtn.click();
                } else {
                    const playRefractionBtn = document.getElementById('playRefractionBtn');
                    if (playRefractionBtn) playRefractionBtn.click();
                }
            }
        });
        
        // 题目切换功能
        document.addEventListener('DOMContentLoaded', function() {
            const problem2Btn = document.getElementById('problem2Btn');
            const problem14Btn = document.getElementById('problem14Btn');
            
            problem2Btn.addEventListener('click', function() {
                // 隐藏所有题目14的部分
                document.getElementById('problem').style.display = 'none';
                document.getElementById('animation').style.display = 'none';
                document.getElementById('knowledge').style.display = 'none';
                document.getElementById('solution').style.display = 'none';
                document.getElementById('similar').style.display = 'none';
                
                // 显示所有题目2的部分
                document.getElementById('problem2').style.display = 'block';
                document.getElementById('animation2').style.display = 'block';
                document.getElementById('knowledge2').style.display = 'block';
                document.getElementById('solution2').style.display = 'block';
                document.getElementById('similar2').style.display = 'block';
                
                // 更新按钮样式
                problem2Btn.classList.remove('bg-gray-200', 'text-dark');
                problem2Btn.classList.add('bg-primary', 'text-white');
                problem14Btn.classList.remove('bg-primary', 'text-white');
                problem14Btn.classList.add('bg-gray-200', 'text-dark');
                
                // 初始化光的折射动画
                initRefractionAnimation();
            });
            
            problem14Btn.addEventListener('click', function() {
                // 隐藏所有题目2的部分
                document.getElementById('problem2').style.display = 'none';
                document.getElementById('animation2').style.display = 'none';
                document.getElementById('knowledge2').style.display = 'none';
                document.getElementById('solution2').style.display = 'none';
                document.getElementById('similar2').style.display = 'none';
                
                // 显示所有题目14的部分
                document.getElementById('problem').style.display = 'block';
                document.getElementById('animation').style.display = 'block';
                document.getElementById('knowledge').style.display = 'block';
                document.getElementById('solution').style.display = 'block';
                document.getElementById('similar').style.display = 'block';
                
                // 更新按钮样式
                problem14Btn.classList.remove('bg-gray-200', 'text-dark');
                problem14Btn.classList.add('bg-primary', 'text-white');
                problem2Btn.classList.remove('bg-primary', 'text-white');
                problem2Btn.classList.add('bg-gray-200', 'text-dark');
            });
        });
        
        // 光的折射动画 - 优化版
        function initRefractionAnimation() {
            console.log('光的折射动画初始化...');
            const canvas = document.getElementById('refractionCanvas');
            const ctx = canvas.getContext('2d');
            const playBtn = document.getElementById('playRefractionBtn');
            const pauseBtn = document.getElementById('pauseRefractionBtn');
            const resetBtn = document.getElementById('resetRefractionBtn');
            const statusText = document.getElementById('refractionStatusText');
            
            // 数据显示元素
            const incidentAngleElement = document.getElementById('incidentAngle');
            const refractionAngleElement = document.getElementById('refractionAngle');
            const exitAngleElement = document.getElementById('exitAngle');
            const stepIndicatorElement = document.getElementById('refractionStepIndicator');
            
            // 速度控制按钮
            const speed05Btn = document.getElementById('refractionSpeed05');
            const speed1Btn = document.getElementById('refractionSpeed1');
            const speed2Btn = document.getElementById('refractionSpeed2');
            const speed3Btn = document.getElementById('refractionSpeed3');
            
            // 设置Canvas尺寸
            function setupCanvas() {
                canvas.width = 800;
                canvas.height = 600;
                canvas.style.display = 'block';
                canvas.style.margin = '0 auto';
            }
            
            setupCanvas();
            
            // 物理参数
            const n1 = 1.0; // 空气折射率
            const n2 = Math.sqrt(2); // 玻璃折射率
            const incidentAngle = 45 * Math.PI / 180; // 入射角（弧度）
            
            // 动画参数
            let animationId = null;
            let isPlaying = false;
            let time = 0;
            let dt = 0.01;
            let speedMultiplier = 1;
            let lightProgress = 0; // 光的传播进度
            let currentStep = 0; // 当前动画步骤
            
            // 圆的参数
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 150;
            
            // 坐标系参数
            const gridSize = 20;
            const axisColor = '#374151';
            const gridColor = '#E5E7EB';
            
            // 计算折射角
            const refractionAngle = Math.asin(n1 * Math.sin(incidentAngle) / n2);
            const exitAngle = incidentAngle; // 由于对称性
            
            // 更新数据显示
            function updateDisplayData() {
                incidentAngleElement.textContent = `${(incidentAngle * 180 / Math.PI).toFixed(1)}°`;
                refractionAngleElement.textContent = `${(refractionAngle * 180 / Math.PI).toFixed(1)}°`;
                exitAngleElement.textContent = `${(exitAngle * 180 / Math.PI).toFixed(1)}°`;
                
                // 更新步骤指示
                let stepText = '';
                if (lightProgress < 0.3) {
                    currentStep = 1;
                    stepText = '步骤1：光线入射（入射角45°）';
                } else if (lightProgress < 0.7) {
                    currentStep = 2;
                    stepText = '步骤2：第一次折射（折射角30°）';
                } else if (lightProgress < 1.0) {
                    currentStep = 3;
                    stepText = '步骤3：光线在圆柱内传播';
                } else {
                    currentStep = 4;
                    stepText = '步骤4：第二次折射（出射角45°，最终与竖直方向夹角0°）';
                }
                
                if (stepIndicatorElement) {
                    stepIndicatorElement.textContent = stepText;
                }
            }
            
            // 绘制坐标系
            function drawCoordinateSystem() {
                // 绘制网格
                ctx.strokeStyle = gridColor;
                ctx.lineWidth = 1;
                
                // 垂直网格线
                for (let x = (centerX % gridSize); x < canvas.width; x += gridSize) {
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, canvas.height);
                    ctx.stroke();
                }
                
                // 水平网格线
                for (let y = (centerY % gridSize); y < canvas.height; y += gridSize) {
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(canvas.width, y);
                    ctx.stroke();
                }
                
                // 绘制坐标轴
                ctx.strokeStyle = axisColor;
                ctx.lineWidth = 2;
                
                // X轴
                ctx.beginPath();
                ctx.moveTo(0, centerY);
                ctx.lineTo(canvas.width, centerY);
                ctx.stroke();
                
                // Y轴
                ctx.beginPath();
                ctx.moveTo(centerX, 0);
                ctx.lineTo(centerX, canvas.height);
                ctx.stroke();
                
                // 坐标轴标签
                ctx.fillStyle = axisColor;
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'top';
                ctx.fillText('X', canvas.width - 20, centerY + 5);
                
                ctx.textAlign = 'left';
                ctx.textBaseline = 'middle';
                ctx.fillText('Y', centerX + 5, 20);
                
                // 绘制刻度和标签
                ctx.font = '10px Arial';
                const unitLabel = 'cm';
                const pixelsPerUnit = 50; // 每个单位50像素
                
                // X轴刻度
                for (let i = -Math.floor((centerX) / pixelsPerUnit); i <= Math.floor((canvas.width - centerX) / pixelsPerUnit); i++) {
                    if (i === 0) continue;
                    const x = centerX + i * pixelsPerUnit;
                    ctx.beginPath();
                    ctx.moveTo(x, centerY - 5);
                    ctx.lineTo(x, centerY + 5);
                    ctx.stroke();
                    ctx.fillText(`${i}${unitLabel}`, x, centerY + 10);
                }
                
                // Y轴刻度
                for (let i = -Math.floor((centerY) / pixelsPerUnit); i <= Math.floor((canvas.height - centerY) / pixelsPerUnit); i++) {
                    if (i === 0) continue;
                    const y = centerY - i * pixelsPerUnit; // Y轴向上为正
                    ctx.beginPath();
                    ctx.moveTo(centerX - 5, y);
                    ctx.lineTo(centerX + 5, y);
                    ctx.stroke();
                    ctx.fillText(`${i}${unitLabel}`, centerX + 10, y);
                }
            }
            
            // 绘制函数
            function draw() {
                if (!ctx) return;
                
                // 清空画布
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // 绘制坐标系
                drawCoordinateSystem();
                
                // 绘制玻璃圆柱（半透明）
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(59, 130, 246, 0.1)';
                ctx.fill();
                ctx.strokeStyle = '#1F2937';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // 绘制入射光线
                const incidentLength = 100;
                const incidentStartX = centerX - incidentLength * Math.sin(incidentAngle);
                const incidentStartY = centerY - incidentLength * Math.cos(incidentAngle);
                const incidentEndX = centerX;
                const incidentEndY = centerY;
                
                ctx.beginPath();
                ctx.moveTo(incidentStartX, incidentStartY);
                ctx.lineTo(incidentEndX, incidentEndY);
                ctx.strokeStyle = '#F59E0B';
                ctx.lineWidth = 3;
                ctx.stroke();
                drawArrow(incidentStartX, incidentStartY, incidentEndX, incidentEndY, '#F59E0B');
                
                // 实时显示光线位置和角度信息
                if (lightProgress > 0) {
                    // 计算当前光线位置
                    const currentRefractionLength = Math.min(lightProgress * radius * Math.sqrt(2), radius * Math.sqrt(2));
                    const currentRayX = centerX + currentRefractionLength * Math.sin(refractionAngle);
                    const currentRayY = centerY + currentRefractionLength * Math.cos(refractionAngle);
                    
                    // 绘制折射光线
                    ctx.beginPath();
                    ctx.moveTo(incidentEndX, incidentEndY);
                    ctx.lineTo(currentRayX, currentRayY);
                    ctx.strokeStyle = '#3B82F6';
                    ctx.lineWidth = 3;
                    ctx.stroke();
                    drawArrow(incidentEndX, incidentEndY, currentRayX, currentRayY, '#3B82F6');
                    
                    // 显示折射点坐标和角度信息
                    ctx.fillStyle = '#3B82F6';
                    ctx.font = '14px Arial';
                    ctx.textAlign = 'left';
                    const xCoord = ((currentRayX - centerX) / 50).toFixed(1);
                    const yCoord = ((centerY - currentRayY) / 50).toFixed(1);
                    ctx.fillText(`位置: (${xCoord}, ${yCoord}) cm`, currentRayX + 10, currentRayY - 20);
                    ctx.fillText(`折射角: 30°`, currentRayX + 10, currentRayY);
                }
                
                // 绘制出射光线和信息
                if (lightProgress > 0.7) {
                    const exitLength = Math.max(0, (lightProgress - 0.7) * 300);
                    const exitPointX = centerX + radius * Math.sin(refractionAngle);
                    const exitPointY = centerY + radius * Math.cos(refractionAngle);
                    const exitEndX = exitPointX + exitLength * Math.sin(exitAngle);
                    const exitEndY = exitPointY + exitLength * Math.cos(exitAngle);
                    
                    ctx.beginPath();
                    ctx.moveTo(exitPointX, exitPointY);
                    ctx.lineTo(exitEndX, exitEndY);
                    ctx.strokeStyle = '#F59E0B';
                    ctx.lineWidth = 3;
                    ctx.stroke();
                    drawArrow(exitPointX, exitPointY, exitEndX, exitEndY, '#F59E0B');
                    
                    // 显示出射点坐标和最终角度信息
                    ctx.fillStyle = '#F59E0B';
                    ctx.font = '14px Arial';
                    const exitXCoord = ((exitPointX - centerX) / 50).toFixed(1);
                    const exitYCoord = ((centerY - exitPointY) / 50).toFixed(1);
                    ctx.fillText(`出射点: (${exitXCoord}, ${exitYCoord}) cm`, exitPointX + 10, exitPointY - 20);
                    ctx.fillText(`最终角度: 0°`, exitPointX + 10, exitPointY);
                }
                
                // 绘制法线
                if (lightProgress > 0) {
                    // 入射点法线（已作为Y轴绘制）
                    
                    // 出射点法线
                    const exitNormalLength = 40;
                    const exitPointX = centerX + radius * Math.sin(refractionAngle);
                    const exitPointY = centerY + radius * Math.cos(refractionAngle);
                    const normalEndX = exitPointX + exitNormalLength * Math.sin(refractionAngle);
                    const normalEndY = exitPointY + exitNormalLength * Math.cos(refractionAngle);
                    
                    ctx.beginPath();
                    ctx.moveTo(exitPointX - exitNormalLength * Math.sin(refractionAngle), 
                              exitPointY - exitNormalLength * Math.cos(refractionAngle));
                    ctx.lineTo(normalEndX, normalEndY);
                    ctx.strokeStyle = '#6B7280';
                    ctx.lineWidth = 1;
                    ctx.setLineDash([5, 5]);
                    ctx.stroke();
                    ctx.setLineDash([]);
                }
                
                // 绘制角度标记 - 与解题步骤一致
                if (lightProgress < 0.7) {
                    // 入射角标记
                    drawAngleArc(centerX, centerY, 40, -Math.PI/2, -Math.PI/2 + incidentAngle, '#F97316', '45°');
                    // 折射角标记
                    drawAngleArc(centerX, centerY, 60, Math.PI/2, Math.PI/2 - refractionAngle, '#3B82F6', '30°');
                }
                
                if (lightProgress > 0.7) {
                    // 出射时的入射角标记（从玻璃到空气）
                    const exitPointX = centerX + radius * Math.sin(refractionAngle);
                    const exitPointY = centerY + radius * Math.cos(refractionAngle);
                    drawAngleArc(exitPointX, exitPointY, 40, 
                                Math.PI/2 + refractionAngle, 
                                Math.PI/2 + refractionAngle + refractionAngle, 
                                '#3B82F6', '30°');
                    // 出射角标记
                    drawAngleArc(exitPointX, exitPointY, 60, 
                                Math.PI/2 + refractionAngle + refractionAngle, 
                                Math.PI/2 + refractionAngle + exitAngle, 
                                '#F97316', '45°');
                }
                
                // 绘制关键公式
                ctx.fillStyle = '#1F2937';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'center';
                if (lightProgress < 0.7) {
                    ctx.fillText('n₁sinθ₁ = n₂sinθ₂', centerX, centerY - radius - 80);
                    ctx.font = '12px Arial';
                    ctx.fillText('1×sin45° = √2×sinθ₂', centerX, centerY - radius - 60);
                } else {
                    ctx.fillText('n₂sinθ₂ = n₁sinθ₃', centerX, centerY - radius - 80);
                    ctx.font = '12px Arial';
                    ctx.fillText('√2×sin30° = 1×sinθ₃', centerX, centerY - radius - 60);
                }
            }
            
            // 绘制箭头
            function drawArrow(x1, y1, x2, y2, color) {
                const headLength = 10;
                const angle = Math.atan2(y2 - y1, x2 - x1);
                
                ctx.beginPath();
                ctx.moveTo(x2, y2);
                ctx.lineTo(x2 - headLength * Math.cos(angle - Math.PI/6), 
                           y2 - headLength * Math.sin(angle - Math.PI/6));
                ctx.moveTo(x2, y2);
                ctx.lineTo(x2 - headLength * Math.cos(angle + Math.PI/6), 
                           y2 - headLength * Math.sin(angle + Math.PI/6));
                ctx.strokeStyle = color;
                ctx.lineWidth = 3;
                ctx.stroke();
            }
            
            // 绘制角度弧
            function drawAngleArc(x, y, radius, startAngle, endAngle, color, label) {
                ctx.beginPath();
                ctx.arc(x, y, radius, startAngle, endAngle);
                ctx.strokeStyle = color;
                ctx.lineWidth = 2;
                ctx.stroke();
                
                const midAngle = (startAngle + endAngle) / 2;
                ctx.fillStyle = color;
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(label, x + (radius + 20) * Math.cos(midAngle), y + (radius + 20) * Math.sin(midAngle));
            }
            
            // 动画更新函数
            function update() {
                if (!isPlaying) return;
                
                time += dt * speedMultiplier;
                lightProgress += 0.005 * speedMultiplier;
                
                // 循环播放
                if (lightProgress >= 1.2) {
                    lightProgress = 0;
                    time = 0;
                }
                
                // 更新数据显示
                updateDisplayData();
                
                // 绘制当前帧
                draw();
                
                // 请求下一帧
                animationId = requestAnimationFrame(update);
            }
            
            // 控制函数
            function startAnimation() {
                if (isPlaying) return;
                isPlaying = true;
                statusText.textContent = '播放中';
                update();
            }
            
            function stopAnimation() {
                isPlaying = false;
                statusText.textContent = '已暂停';
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    animationId = null;
                }
            }
            
            function resetAnimation() {
                stopAnimation();
                time = 0;
                lightProgress = 0;
                statusText.textContent = '准备就绪';
                updateDisplayData();
                draw();
            }
            
            // 设置速度控制
            function setupSpeedControls() {
                function resetButtonStyles() {
                    speed05Btn.classList.remove('bg-primary', 'text-white');
                    speed1Btn.classList.remove('bg-primary', 'text-white');
                    speed2Btn.classList.remove('bg-primary', 'text-white');
                    speed3Btn.classList.remove('bg-primary', 'text-white');
                    
                    speed05Btn.classList.add('bg-gray-200', 'hover:bg-gray-300');
                    speed1Btn.classList.add('bg-gray-200', 'hover:bg-gray-300');
                    speed2Btn.classList.add('bg-gray-200', 'hover:bg-gray-300');
                    speed3Btn.classList.add('bg-gray-200', 'hover:bg-gray-300');
                }
                
                speed05Btn.addEventListener('click', function() {
                    resetButtonStyles();
                    speed05Btn.classList.remove('bg-gray-200', 'hover:bg-gray-300');
                    speed05Btn.classList.add('bg-primary', 'text-white');
                    speedMultiplier = 0.5;
                });
                
                speed1Btn.addEventListener('click', function() {
                    resetButtonStyles();
                    speed1Btn.classList.remove('bg-gray-200', 'hover:bg-gray-300');
                    speed1Btn.classList.add('bg-primary', 'text-white');
                    speedMultiplier = 1;
                });
                
                speed2Btn.addEventListener('click', function() {
                    resetButtonStyles();
                    speed2Btn.classList.remove('bg-gray-200', 'hover:bg-gray-300');
                    speed2Btn.classList.add('bg-primary', 'text-white');
                    speedMultiplier = 2;
                });
                
                speed3Btn.addEventListener('click', function() {
                    resetButtonStyles();
                    speed3Btn.classList.remove('bg-gray-200', 'hover:bg-gray-300');
                    speed3Btn.classList.add('bg-primary', 'text-white');
                    speedMultiplier = 3;
                });
            }
            
            // 绑定事件
            if (playBtn) {
                // 移除旧的监听器（如果有）
                const newPlayBtn = playBtn.cloneNode(true);
                playBtn.parentNode.replaceChild(newPlayBtn, playBtn);
                newPlayBtn.addEventListener('click', startAnimation);
            }
            
            if (pauseBtn) {
                const newPauseBtn = pauseBtn.cloneNode(true);
                pauseBtn.parentNode.replaceChild(newPauseBtn, pauseBtn);
                newPauseBtn.addEventListener('click', stopAnimation);
            }
            
            if (resetBtn) {
                const newResetBtn = resetBtn.cloneNode(true);
                resetBtn.parentNode.replaceChild(newResetBtn, resetBtn);
                newResetBtn.addEventListener('click', resetAnimation);
            }
            
            // 设置速度控制
            setupSpeedControls();
            
            // 初始更新
            updateDisplayData();
            draw();
            
            console.log('光的折射动画初始化完成');
        }
    </script>
</body>
</html>